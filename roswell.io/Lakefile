#|-*- mode:lisp -*-|#
(in-package :cl-user)
(defpackage :lake.user
  (:use :cl :lake :cl-syntax)
  (:shadowing-import-from :lake
                          :directory))
(in-package :lake.user)

(use-syntax :interpol)

(task "default" ()
  (mapc #'sh
        `("git clone -b ci https://github.com/roswell/roswell.github.io.git ci"
          ,(format nil "cd ci;git clone -b master https://~A:x-oauth-basic@github.com/roswell/roswell.github.io.git _public" (ros:getenv "GITHUB_OAUTH_TOKEN"))
          "cd ci;rm -rf _public/*"
          "cd ci;./wiki2html.ros"
          "cd ci;cp _public/Home.html _public/index.html"
          "cd ci;cp style.css _public/style.css"
          "cd ci;make upload")))
